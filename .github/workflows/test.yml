name: Test Static Server Action

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Start static server
        id: server
        uses: johnz86/static-serve-action@v1
        with:
          directory: ./test
          port: 3000
          
      - name: Test server
        run: |
          echo "Server URL: ${{ steps.server.outputs.url }}"
          curl -f ${{ steps.server.outputs.url }}
          echo "âœ… Server is working!"
          
      - name: Cleanup
        if: always()
        run: |
          [[ -n "${{ steps.server.outputs.pid }}" ]] && kill ${{ steps.server.outputs.pid }} || true
    